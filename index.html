<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Then vs Now Housing Affordability • Jason Kaczmarski Team</title>
  <style>
    :root{
      --remax-red:#e21b23;
      --remax-blue:#003da5;
      --text:#111827;
      --muted:#6b7280;
      --bg:#f8fafc;
      --card:#ffffff;
      --line:#e5e7eb;
      --shadow: 0 8px 24px rgba(0,0,0,.08);
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background: linear-gradient(180deg, #fff 0, var(--bg) 55%);
    }
    .topbar{
      background: var(--remax-red);
      height: 18px;
    }
    .bottombar{
      background: var(--remax-blue);
      height: 18px;
      margin-top: 28px;
    }
    .wrap{
      max-width: 1100px;
      margin: 22px auto 0;
      padding: 0 16px 28px;
    }
    .header{
      display:flex;
      align-items:center;
      gap:14px;
      margin: 14px 0 14px;
    }
    .logo{
      width: 76px;
      height: 76px;
      border-radius: 14px;
      background:#fff;
      padding:10px;
      box-shadow: var(--shadow);
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }
    .logo img{width:100%; height:100%; object-fit:contain}
    h1{
      font-size: 22px;
      margin:0;
      line-height:1.2;
      letter-spacing:-0.01em;
    }
    .sub{
      margin:4px 0 0;
      color:var(--muted);
      font-size: 14px;
    }
    .card{
      background: var(--card);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
    }

    .controls{
      display:flex;
      flex-wrap:wrap;
      gap: 10px 14px;
      align-items: end;
      margin-bottom: 14px;
    }
    .field{
      display:flex;
      flex-direction:column;
      gap:6px;
      min-width: 220px;
    }
    label{
      font-size: 12px;
      color:var(--muted);
    }
    select, input{
      font-size: 14px;
      padding: 10px 12px;
      border:1px solid var(--line);
      border-radius: 12px;
      outline:none;
      background:#fff;
    }
    input:focus, select:focus{
      border-color: rgba(0,61,165,.5);
      box-shadow: 0 0 0 3px rgba(0,61,165,.12);
    }

    .split{
      display:grid;
      grid-template-columns: 1fr 1px 1fr;
      gap: 16px;
      align-items: start;
      margin-top: 8px;
    }
    .divider{
      background: var(--line);
      width:1px;
      height: 100%;
      border-radius: 99px;
    }
    .pane h2{
      margin: 0 0 10px;
      font-size: 16px;
      letter-spacing: -0.01em;
    }
    .muted{
      color:var(--muted);
      font-size: 12px;
      margin: -6px 0 10px;
    }
    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .stat{
      border:1px solid var(--line);
      border-radius: 14px;
      padding: 12px;
      background: #fff;
    }
    .stat .k{font-size: 12px;color:var(--muted);margin-bottom:6px}
    .stat .v{font-size: 18px;font-weight: 700}
    .stat .s{font-size: 12px;color:var(--muted);margin-top:4px}

    .sectionTitle{
      margin: 14px 0 8px;
      font-size: 13px;
      color: var(--muted);
      display:flex;
      align-items:center;
      gap:8px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      padding: 4px 8px;
      border-radius: 999px;
      border:1px solid var(--line);
      background: #f9fafb;
      font-size: 12px;
      color: var(--muted);
    }

    .toggles{
      display:flex;
      flex-wrap:wrap;
      gap: 10px;
      margin-top: 10px;
    }
    .toggle{
      display:flex;
      gap: 8px;
      align-items:center;
      padding: 10px 12px;
      border:1px dashed var(--line);
      border-radius: 14px;
      background:#fff;
    }
    .toggle input{width:16px;height:16px;padding:0}
    .toggle span{font-size: 13px;color:var(--text)}
    .toggle small{display:block;color:var(--muted);font-size: 12px;margin-top:2px}

    .foot{
      margin-top: 16px;
      font-size: 12px;
      color: var(--muted);
      line-height: 1.45;
    }
    .foot a{color: var(--remax-blue); text-decoration: none}
    .foot a:hover{text-decoration: underline}

    .btnRow{
      margin-top: 12px;
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      justify-content: space-between;
      align-items:center;
    }
    .button{
      cursor:pointer;
      border: 1px solid var(--line);
      background:#fff;
      padding: 10px 12px;
      border-radius: 12px;
      font-size: 13px;
    }
    .button:hover{border-color: rgba(0,0,0,.25)}
    .hint{
      font-size: 12px;
      color: var(--muted);
    }
  </style>
</head>
<body>
  <div class="topbar"></div>

  <div class="wrap">
    <div class="header">
      <div class="logo">
        <!-- Team Logo (Color) you shared previously -->
        <img alt="Jason Kaczmarski Team Logo"
             src="https://kvcore-library.s3.amazonaws.com/remax1stchoice8207/images/03b9616f75a8e185d56a93c799829fdf.png" />
      </div>
      <div>
        <h1>Then vs Now: Housing Affordability (National Averages)</h1>
        <div class="sub">Compare “Today / Latest” vs a historical year and see payment + % of income.</div>
      </div>
    </div>

    <div class="card">
      <div class="controls">
        <div class="field">
          <label for="compareYear">Compare year (5-year intervals)</label>
          <select id="compareYear"></select>
        </div>

        <div class="field">
          <label for="downPct">Down payment % (both sides)</label>
          <input id="downPct" type="number" step="0.1" min="0" max="100" value="10" />
        </div>

        <div class="field">
          <label for="termYears">Loan term (years)</label>
          <input id="termYears" type="number" step="1" min="5" max="40" value="30" />
        </div>

        <div class="field">
          <label for="incomeMode">Income basis</label>
          <select id="incomeMode">
            <option value="annual">Annual income</option>
            <option value="monthly">Monthly income</option>
          </select>
        </div>
      </div>

      <div class="toggles">
        <div class="toggle">
          <input id="includeTaxes" type="checkbox" />
          <div>
            <span>Include property taxes (optional)</span>
            <small>Uses a simple effective rate for illustration.</small>
          </div>
        </div>
        <div class="toggle">
          <input id="includeIns" type="checkbox" />
          <div>
            <span>Include insurance (optional)</span>
            <small>Flat monthly estimate for illustration.</small>
          </div>
        </div>
      </div>

      <div class="controls" style="margin-top:10px;">
        <div class="field">
          <label for="taxRate">Property tax effective rate (annual % of home price)</label>
          <input id="taxRate" type="number" step="0.01" min="0" max="10" value="1.10" />
        </div>
        <div class="field">
          <label for="insMonthly">Insurance (monthly $)</label>
          <input id="insMonthly" type="number" step="1" min="0" value="150" />
        </div>
        <div class="field">
          <label for="ptiNote">What counts as “housing” in % of income?</label>
          <select id="ptiNote">
            <option value="pi">P&I only</option>
            <option value="pit">P&I + taxes (if checked)</option>
            <option value="piti">P&I + taxes + insurance (if checked)</option>
          </select>
        </div>
      </div>

      <div class="split">
        <div class="pane" id="todayPane">
          <h2>Today / Latest</h2>
          <div class="muted" id="todayMeta"></div>

          <div class="sectionTitle">
            <span class="pill">Inputs</span>
            <span class="hint">You can override these numbers.</span>
          </div>

          <div class="grid">
            <div class="field">
              <label for="todayPrice">Home price ($)</label>
              <input id="todayPrice" type="number" step="100" />
            </div>
            <div class="field">
              <label for="todayIncome">Income ($)</label>
              <input id="todayIncome" type="number" step="100" />
            </div>
            <div class="field">
              <label for="todayRate">Interest rate (%)</label>
              <input id="todayRate" type="number" step="0.01" />
            </div>
            <div class="field">
              <label for="todayRent">Average rent ($/mo, illustrative)</label>
              <input id="todayRent" type="number" step="1" />
            </div>
          </div>

          <div class="sectionTitle"><span class="pill">Results</span></div>
          <div class="grid">
            <div class="stat">
              <div class="k">Monthly payment (P&I)</div>
              <div class="v" id="todayPI">$—</div>
              <div class="s" id="todayLoan">$— loan amount</div>
            </div>
            <div class="stat">
              <div class="k">Housing payment as % of income</div>
              <div class="v" id="todayPct">—%</div>
              <div class="s" id="todayWhat">basis: P&I only</div>
            </div>
            <div class="stat">
              <div class="k">Rent as % of income</div>
              <div class="v" id="todayRentPct">—%</div>
              <div class="s">illustrative rent share</div>
            </div>
            <div class="stat">
              <div class="k">Payment-to-income “gap” vs rent</div>
              <div class="v" id="todayGap">$—</div>
              <div class="s">(housing payment − rent)</div>
            </div>
          </div>
        </div>

        <div class="divider"></div>

        <div class="pane" id="pastPane">
          <h2 id="pastTitle">Compare Year</h2>
          <div class="muted" id="pastMeta"></div>

          <div class="sectionTitle">
            <span class="pill">Inputs</span>
            <span class="hint">Auto-fills from the dataset; override anytime.</span>
          </div>

          <div class="grid">
            <div class="field">
              <label for="pastPrice">Home price ($)</label>
              <input id="pastPrice" type="number" step="100" />
            </div>
            <div class="field">
              <label for="pastIncome">Income ($)</label>
              <input id="pastIncome" type="number" step="100" />
            </div>
            <div class="field">
              <label for="pastRate">Interest rate (%)</label>
              <input id="pastRate" type="number" step="0.01" />
            </div>
            <div class="field">
              <label for="pastRent">Average rent ($/mo, illustrative)</label>
              <input id="pastRent" type="number" step="1" />
            </div>
          </div>

          <div class="sectionTitle"><span class="pill">Results</span></div>
          <div class="grid">
            <div class="stat">
              <div class="k">Monthly payment (P&I)</div>
              <div class="v" id="pastPI">$—</div>
              <div class="s" id="pastLoan">$— loan amount</div>
            </div>
            <div class="stat">
              <div class="k">Housing payment as % of income</div>
              <div class="v" id="pastPct">—%</div>
              <div class="s" id="pastWhat">basis: P&I only</div>
            </div>
            <div class="stat">
              <div class="k">Rent as % of income</div>
              <div class="v" id="pastRentPct">—%</div>
              <div class="s">illustrative rent share</div>
            </div>
            <div class="stat">
              <div class="k">Payment-to-income “gap” vs rent</div>
              <div class="v" id="pastGap">$—</div>
              <div class="s">(housing payment − rent)</div>
            </div>
          </div>
        </div>
      </div>

      <div class="btnRow">
        <button class="button" id="resetBtn" type="button">Reset inputs to dataset</button>
        <div class="hint">Tip: turn on Taxes/Insurance to approximate “PITI” share.</div>
      </div>

      <div class="foot">
        <div><strong>* Disclaimer:</strong> This tool uses national historical averages and simplified assumptions. It is for illustration only and is not financial advice.</div>
        <div style="margin-top:8px;">
          <strong>Sources (national):</strong>
          <ul>
            <li>Home price: FRED “Median Sales Price of Houses Sold” (MSPUS, quarterly; using Q4 for year points and latest for “Today”).</li>
            <li>Income: FRED “Real Median Family Income in the United States” (MEFAINUSA672N, annual).</li>
            <li>Mortgage rate (Today default): Freddie Mac PMMS 30-year fixed rate as of Jan 29, 2026 (6.10%).</li>
            <li>Rent: Census QuickFacts “Median gross rent (2020–2024) $1,413” used as an anchor, scaled by FRED CPI “Rent of Primary Residence” (CUUR0000SEHA, Dec points).</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="bottombar"></div>
  </div>

<script>
  // ----------------------------
  // Dataset (5-year intervals)
  // ----------------------------
  // Home price: MSPUS (median sales price of new houses sold), using Q4 (10-01) for each year.
  // Income: MEFAINUSA672N (real median family income).
  // Rent: illustrative estimate anchored to Census QuickFacts (2020–2024 median gross rent = $1,413),
  //       scaled by CUUR0000SEHA (CPI rent index) at Dec points.
  //
  // Mortgage rates:
  // - "today" defaults to Freddie Mac PMMS 30-yr as of 2026-01-29: 6.10%
  // - Historical rates are left blank by default (user can fill). If you want, we can add them later.
  const DATA = {
    today: {
      label: "Today / Latest",
      asOf: "Home price: 2025-04-01 (latest quarterly). Income: 2024 (latest annual). Rate: 2026-01-29 PMMS.",
      homePrice: 410800,     // MSPUS 2025-04-01
      incomeAnnual: 105800,  // MEFAINUSA 2024
      ratePct: 6.10,         // Freddie Mac PMMS as of Jan 29, 2026
      rentMonthly: 1459      // estimated via CPI scaling (see notes)
    },
    years: {
      1980: { homePrice:  66400, incomeAnnual:  71470, ratePct: 14.95, rentMonthly: 279, note: "Home price Q4 1980; income 1980; rate is Dec 1980 weekly point; rent is illustrative." },
      1985: { homePrice:  86800, incomeAnnual:  72300, ratePct: 11.09, rentMonthly: 372, note: "Home price Q4 1985; income 1985; rate is Dec 1985 weekly point; rent is illustrative." },
      1990: { homePrice: 121500, incomeAnnual:  77260, ratePct: null,  rentMonthly: 453, note: "Fill rate if desired." },
      1995: { homePrice: 138000, incomeAnnual:  77920, ratePct: null,  rentMonthly: 539, note: "Fill rate if desired." },
      2000: { homePrice: 172900, incomeAnnual:  86740, ratePct: null,  rentMonthly: 636, note: "Fill rate if desired." },
      2005: { homePrice: 243600, incomeAnnual:  86190, ratePct: null,  rentMonthly: 757, note: "Fill rate if desired." },
      2010: { homePrice: 224300, incomeAnnual:  83640, ratePct: null,  rentMonthly: 850, note: "Fill rate if desired." },
      2015: { homePrice: 302500, incomeAnnual:  91060, ratePct: null,  rentMonthly: 942, note: "Fill rate if desired." },
      2020: { homePrice: 338600, incomeAnnual: 101200, ratePct: null,  rentMonthly: 1229, note: "Fill rate if desired." },
      2025: { homePrice: 410800, incomeAnnual: 105800, ratePct: null,  rentMonthly: 1459, note: "Same home price/income basis as Today; rate differs." }
    }
  };

  // ----------------------------
  // Helpers
  // ----------------------------
  const fmtMoney = (n) => {
    if (n === null || n === undefined || isNaN(n)) return "$—";
    return n.toLocaleString(undefined, { style: "currency", currency: "USD", maximumFractionDigits: 0 });
  };
  const fmtMoney2 = (n) => {
    if (n === null || n === undefined || isNaN(n)) return "$—";
    return n.toLocaleString(undefined, { style: "currency", currency: "USD", maximumFractionDigits: 2 });
  };
  const fmtPct = (n) => {
    if (n === null || n === undefined || isNaN(n)) return "—%";
    return `${n.toFixed(1)}%`;
  };

  function monthlyPI(loanAmount, ratePct, termYears){
    if (!loanAmount || loanAmount <= 0) return null;
    if (ratePct === null || ratePct === undefined || isNaN(ratePct)) return null;
    const r = (ratePct/100)/12;
    const n = termYears*12;
    if (r === 0) return loanAmount / n;
    const pmt = loanAmount * (r * Math.pow(1+r, n)) / (Math.pow(1+r, n) - 1);
    return pmt;
  }

  function housingMonthlyTotal({homePrice, downPct, ratePct, termYears, includeTaxes, taxRatePct, includeIns, insMonthly}){
    const down = homePrice * (downPct/100);
    const loan = Math.max(homePrice - down, 0);
    const pi = monthlyPI(loan, ratePct, termYears);
    const taxes = includeTaxes ? (homePrice * (taxRatePct/100) / 12) : 0;
    const ins = includeIns ? insMonthly : 0;
    const total = (pi === null ? null : (pi + taxes + ins));
    return { down, loan, pi, taxes, ins, total };
  }

  function monthlyIncome(income, mode){
    if (!income || income <= 0) return null;
    return mode === "monthly" ? income : (income/12);
  }

  // ----------------------------
  // UI wiring
  // ----------------------------
  const el = (id) => document.getElementById(id);

  const compareYear = el("compareYear");
  const downPct = el("downPct");
  const termYears = el("termYears");
  const incomeMode = el("incomeMode");

  const includeTaxes = el("includeTaxes");
  const includeIns = el("includeIns");
  const taxRate = el("taxRate");
  const insMonthly = el("insMonthly");
  const ptiNote = el("ptiNote");

  // Today inputs
  const todayPrice = el("todayPrice");
  const todayIncome = el("todayIncome");
  const todayRate = el("todayRate");
  const todayRent = el("todayRent");

  // Past inputs
  const pastPrice = el("pastPrice");
  const pastIncome = el("pastIncome");
  const pastRate = el("pastRate");
  const pastRent = el("pastRent");

  function populateYearDropdown(){
    const years = Object.keys(DATA.years).map(Number).sort((a,b)=>a-b);
    compareYear.innerHTML = years.map(y => `<option value="${y}">${y}</option>`).join("");
    compareYear.value = "1980";
  }

  function setInputsFromDataset(){
    // Today
    todayPrice.value = DATA.today.homePrice;
    todayIncome.value = DATA.today.incomeAnnual;
    todayRate.value = DATA.today.ratePct;
    todayRent.value = DATA.today.rentMonthly;

    // Past
    const y = Number(compareYear.value);
    const row = DATA.years[y];
    pastPrice.value = row.homePrice;
    pastIncome.value = row.incomeAnnual;
    pastRate.value = (row.ratePct === null ? "" : row.ratePct);
    pastRent.value = row.rentMonthly;

    el("todayMeta").textContent = DATA.today.asOf;
    el("pastTitle").textContent = `Compare Year: ${y}`;
    el("pastMeta").textContent = row.note || "";
  }

  function computeSide(side){
    const isToday = side === "today";
    const price = Number(isToday ? todayPrice.value : pastPrice.value);
    const income = Number(isToday ? todayIncome.value : pastIncome.value);
    const rate = (isToday ? todayRate.value : pastRate.value);
    const rent = Number(isToday ? todayRent.value : pastRent.value);

    const dPct = Number(downPct.value);
    const tYears = Number(termYears.value);
    const incMode = incomeMode.value;

    const incMonthly = monthlyIncome(income, incMode);

    const res = housingMonthlyTotal({
      homePrice: price,
      downPct: dPct,
      ratePct: (rate === "" ? NaN : Number(rate)),
      termYears: tYears,
      includeTaxes: includeTaxes.checked,
      taxRatePct: Number(taxRate.value),
      includeIns: includeIns.checked,
      insMonthly: Number(insMonthly.value),
    });

    // What counts as housing for % of income?
    let housingForPct = res.pi;
    let basis = "P&I only";
    if (ptiNote.value === "pit") {
      housingForPct = (res.pi === null ? null : (res.pi + (includeTaxes.checked ? res.taxes : 0)));
      basis = includeTaxes.checked ? "P&I + taxes" : "P&I only (taxes not included)";
    }
    if (ptiNote.value === "piti") {
      housingForPct = res.total;
      basis = (includeTaxes.checked || includeIns.checked)
        ? `P&I +${includeTaxes.checked ? " taxes" : ""}${includeIns.checked ? " + insurance" : ""}`
        : "P&I only (taxes/insurance not included)";
    }

    const pctIncome = (incMonthly && housingForPct !== null) ? (housingForPct / incMonthly * 100) : null;
    const rentPctIncome = (incMonthly && rent) ? (rent / incMonthly * 100) : null;
    const gap = (housingForPct !== null && rent) ? (housingForPct - rent) : null;

    return { price, income, rate, rent, incMonthly, ...res, housingForPct, pctIncome, rentPctIncome, gap, basis };
  }

  function render(){
    const t = computeSide("today");
    const p = computeSide("past");

    // Today
    el("todayPI").textContent = fmtMoney2(t.pi);
    el("todayLoan").textContent = `${fmtMoney(t.loan)} loan amount`;
    el("todayPct").textContent = fmtPct(t.pctIncome);
    el("todayWhat").textContent = `basis: ${t.basis}`;
    el("todayRentPct").textContent = fmtPct(t.rentPctIncome);
    el("todayGap").textContent = fmtMoney2(t.gap);

    // Past
    el("pastPI").textContent = fmtMoney2(p.pi);
    el("pastLoan").textContent = `${fmtMoney(p.loan)} loan amount`;
    el("pastPct").textContent = fmtPct(p.pctIncome);
    el("pastWhat").textContent = `basis: ${p.basis}`;
    el("pastRentPct").textContent = fmtPct(p.rentPctIncome);
    el("pastGap").textContent = fmtMoney2(p.gap);
  }

  // Events
  function wire(){
    const ids = [
      "compareYear","downPct","termYears","incomeMode",
      "includeTaxes","includeIns","taxRate","insMonthly","ptiNote",
      "todayPrice","todayIncome","todayRate","todayRent",
      "pastPrice","pastIncome","pastRate","pastRent"
    ];
    ids.forEach(id=>{
      el(id).addEventListener("input", render);
      el(id).addEventListener("change", ()=>{
        if(id==="compareYear") setInputsFromDataset();
        render();
      });
    });
    el("resetBtn").addEventListener("click", ()=>{
      setInputsFromDataset();
      render();
    });
  }

  // Init
  populateYearDropdown();
  setInputsFromDataset();
  wire();
  render();
</script>
</body>
</html>
